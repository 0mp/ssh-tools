#!/usr/bin/env bash

  BLACK=$(tput setaf 0)
    RED=$(tput setaf 1)
  GREEN=$(tput setaf 2)
 YELLOW=$(tput setaf 3)
   BLUE=$(tput setaf 4)
MAGENTA=$(tput setaf 5)
   CYAN=$(tput setaf 6)
  WHITE=$(tput setaf 7)
   BOLD=$(tput bold   )
RESET=$(tput sgr0   )

remote_host=$1

fingerprint_hashes=( md5 sha256 )

function get_fingerprints () {

  hash_type=$1

  ssh-keygen -E $hash_type -qlf <(ssh-keyscan $remote_host 2>/dev/null) | while IFS= read -r line; do
    key_data=( $(printf '%s\n' "$line") )
    key_size=${key_data[0]}
    key_hash=${key_data[1]}
    key_remote_host=${key_data[2]}
    key_type=${key_data[3]}
    key_hash_type="${key_hash%%:*}"
    key_hash_data="${key_hash#*:}"

    if [[ $key_type == *"DSA"* ]]; then

      if [[ $key_type == *"ECDSA"* ]]; then
        printf "${MAGENTA}%10s\t%10s\t%10s\t%s${RESET}\n" $key_type $key_size $key_hash_type $key_hash_data
        continue
      else
        printf "${YELLOW}%10s\t%10s\t%10s\t%s${RESET}\n" $key_type $key_size $key_hash_type $key_hash_data
        continue
      fi
    fi

    if [[ $key_type == *"RSA"* || $key_type == *"ED25519"* ]]; then
       printf "${GREEN}%10s\t%10s\t%10s\t%s${RESET}\n" $key_type $key_size $key_hash_type $key_hash_data
       continue
    else
       printf "${CYAN}%10s\t%10s\t%10s\t%s${RESET}\n" $key_type $key_size $key_hash_type $key_hash_data
       continue
    fi

  done

}

for fingerprint_hash in ${fingerprint_hashes[@]}; do

  get_fingerprints $fingerprint_hash

done | sort
